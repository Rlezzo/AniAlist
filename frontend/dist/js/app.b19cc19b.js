(function(){"use strict";var e={2048:function(e,t,a){var n=a(5130),s=a(6768);const l={id:"app"},o={key:0};function r(e,t,a,n,r,i){const d=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",l,[i.isLoginOrNotFound?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("header",o,t[0]||(t[0]=[(0,s.Lk)("h1",null,"欢迎使用 RSS 管理系统",-1)]))),(0,s.bF)(d)])}var i={name:"App",computed:{isLoginOrNotFound(){return"Login"===this.$route.name||"NotFound"===this.$route.name}}},d=a(1241);const u=(0,d.A)(i,[["render",r]]);var c=u,g=(a(8992),a(7550),a(973)),p=a(4232);const h={class:"login-container"},k={class:"login-form"},m={key:0,class:"error-message"};function L(e,t,a,l,o,r){return(0,s.uX)(),(0,s.CE)("div",h,[t[3]||(t[3]=(0,s.Lk)("h2",null,"登录系统",-1)),(0,s.Lk)("div",k,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.username=e),type:"text",placeholder:"请输入用户名",class:"login-input"},null,512),[[n.Jo,o.username]]),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.password=e),type:"password",placeholder:"请输入密码",class:"login-input"},null,512),[[n.Jo,o.password]]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.login&&r.login(...e)),class:"login-button"},"登录"),o.loginError?((0,s.uX)(),(0,s.CE)("div",m,(0,p.v_)(o.loginError),1)):(0,s.Q3)("",!0)])])}a(4114),a(1454);var f=a(4373);const b=f.A.create({baseURL:"http://127.0.0.1:5000/api",headers:{"Content-Type":"application/json"},withCredentials:!0}),v=()=>b.get("/rss"),y=e=>b.post("/rss",e),S=e=>b.delete(`/rss/${e}`),F=(e,t)=>b.patch(`/rss/${e}`,t),w=(e,t)=>b.patch(`/rss/${e}/rename`,t),C=e=>b.post(`/rss/${e}/refresh`),E=e=>{const t=e.map((e=>C(e)));return Promise.all(t)},_=e=>b.get(`/rss/${e}`),I=e=>b.get(`/magnets/rss/${e}`),R=e=>b.post(`/magnets/${e}/retry`),P=()=>b.post("/magnets/queue/start"),U=(e,t,a,n,s,l)=>b.get("/logs",{params:{level:e||"ALL",start_date:t||"",end_date:a||"",include_details:n,page:s||1,page_size:l||20}}),D=async(e,t)=>{try{const a=await b.post("/auth/login",{username:e,password:t}),n=a.data.token;return n&&localStorage.setItem("token",n),a.data}catch(a){throw console.error("登录失败:",a.response?.data?.message||a.message),a}};b.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>(console.error("请求拦截器错误:",e),Promise.reject(e)))),b.interceptors.response.use((e=>e),(async e=>{if(401===e.response?.status&&"Token has expired!"===e.response?.data?.message)try{const t=await b.post("/auth/refresh"),a=t.data.token;if(a)return localStorage.setItem("token",a),e.config.headers.Authorization=`Bearer ${a}`,b.request(e.config)}catch{localStorage.removeItem("token"),window.location.href="/login"}return Promise.reject(e)}));const $=()=>b.get("/login_logs");var A={data(){return{username:"",password:"",loginError:""}},methods:{async login(){try{const e=await D(this.username,this.password),t=e.token;localStorage.setItem("token",t),this.$router.push({name:"RSSFeeds"})}catch(e){this.loginError="用户名或密码错误，请重试"}}}};const M=(0,d.A)(A,[["render",L],["__scopeId","data-v-064c72d4"]]);var N=M;const x={class:"container"},X={class:"header"},O={class:"user-controls"},T={class:"welcome-message"},V={class:"button-group"},j=["disabled"],J={class:"feeds-section"},q={class:"filter-options"},z={class:"filter-label"},Q={class:"filter-label"},W={class:"filter-label"},G={class:"rss-table"},B=["onClick"],H=["href"],K=["onUpdate:modelValue","onChange"],Y={key:0,class:"actions"},Z=["onClick"],ee=["onClick"],te=["onClick","disabled"],ae={key:1,class:"edit-form"},ne=["onUpdate:modelValue"],se=["onUpdate:modelValue"],le={class:"edit-actions"},oe=["onClick"],re=["onClick"],ie={class:"pagination"},de=["disabled"],ue={class:"pagination-info"},ce=["disabled"],ge={class:"page-input-container"},pe=["max"],he={class:"add-rss-container"},ke={class:"add-rss-form"},me=["disabled"];function Le(e,t,a,l,o,r){return(0,s.uX)(),(0,s.CE)("div",x,[(0,s.Lk)("header",X,[t[18]||(t[18]=(0,s.Lk)("h2",null,"RSS Feeds 管理",-1)),(0,s.Lk)("div",O,[(0,s.Lk)("p",T,"Welcome，"+(0,p.v_)(o.username)+"！",1),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.logout&&r.logout(...e)),class:"logout-button"},"退出登录")])]),(0,s.Lk)("div",V,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=t=>e.$router.push({name:"LoginLogs"})),class:"button-group-item view-logs-button"},"查看登录记录"),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.viewLogs&&r.viewLogs(...e)),class:"button-group-item system-logs-button"},"查看系统日志"),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.refreshAllRssFeeds&&r.refreshAllRssFeeds(...e)),disabled:o.refreshingAll,class:"button-group-item refresh-all-button"}," 更新所有勾选的 RSS 源 ",8,j),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.startTaskQueue&&r.startTaskQueue(...e)),class:"button-group-item start-queue-button"},"启动任务队列")]),(0,s.Lk)("section",J,[t[26]||(t[26]=(0,s.Lk)("h1",null,"RSS Feeds",-1)),(0,s.Lk)("div",q,[(0,s.Lk)("label",z,[t[19]||(t[19]=(0,s.Lk)("span",null,"按更新时间筛选：",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=e=>o.filterDate=e),onChange:t[6]||(t[6]=(...e)=>r.applyFilters&&r.applyFilters(...e)),class:"date-input"},null,544),[[n.Jo,o.filterDate]])]),(0,s.Lk)("label",Q,[t[21]||(t[21]=(0,s.Lk)("span",null,"是否更新：",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>o.filterShouldUpdate=e),onChange:t[8]||(t[8]=(...e)=>r.applyFilters&&r.applyFilters(...e)),class:"select-input"},t[20]||(t[20]=[(0,s.Lk)("option",{value:""},"全部",-1),(0,s.Lk)("option",{value:"true"},"是",-1),(0,s.Lk)("option",{value:"false"},"否",-1)]),544),[[n.u1,o.filterShouldUpdate]])]),(0,s.Lk)("label",W,[t[22]||(t[22]=(0,s.Lk)("span",null,"名称搜索：",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=e=>o.searchName=e),onInput:t[10]||(t[10]=(...e)=>r.applyFilters&&r.applyFilters(...e)),class:"text-input",placeholder:"搜索名称"},null,544),[[n.Jo,o.searchName]])])]),(0,s.Lk)("table",G,[t[23]||(t[23]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"名称"),(0,s.Lk)("th",null,"URL"),(0,s.Lk)("th",null,"上次更新"),(0,s.Lk)("th",null,"是否更新"),(0,s.Lk)("th",null,"操作")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.paginatedFeeds,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",{onClick:t=>r.viewMagnets(e),class:"clickable"},(0,p.v_)(e.name),9,B),(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:e.url,target:"_blank"},"订阅地址",8,H)]),(0,s.Lk)("td",null,(0,p.v_)(e.last_updated?e.last_updated:"未更新"),1),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.should_update=t,onChange:t=>r.updateShouldUpdate(e)},null,40,K),[[n.lH,e.should_update]])]),(0,s.Lk)("td",null,[e.isEditing?((0,s.uX)(),(0,s.CE)("div",ae,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.newName=t,placeholder:"名称",class:"edit-input"},null,8,ne),[[n.Jo,e.newName]]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.newUrl=t,placeholder:"URL",class:"edit-input"},null,8,se),[[n.Jo,e.newUrl]]),(0,s.Lk)("div",le,[(0,s.Lk)("button",{onClick:t=>r.saveFeedChanges(e),class:"save-button"},"保存",8,oe),(0,s.Lk)("button",{onClick:t=>r.cancelEdit(e),class:"cancel-button"},"取消",8,re)])])):((0,s.uX)(),(0,s.CE)("div",Y,[(0,s.Lk)("button",{onClick:t=>r.editFeed(e),class:"edit-button"},"编辑",8,Z),(0,s.Lk)("button",{onClick:t=>r.confirmDeleteFeed(e.id),class:"delete-button"},"删除",8,ee),(0,s.Lk)("button",{onClick:t=>r.refreshSingleRssFeed(e.id),disabled:o.refreshingFeedId===e.id,class:"refresh-button"}," 更新订阅 ",8,te)]))])])))),128))])]),(0,s.Lk)("div",ie,[(0,s.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>r.prevPage&&r.prevPage(...e)),disabled:1===o.currentPage,class:"pagination-button prev-page-button"}," 上一页 ",8,de),(0,s.Lk)("span",ue,"第 "+(0,p.v_)(o.currentPage)+" 页，共 "+(0,p.v_)(r.totalPages)+" 页",1),(0,s.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>r.nextPage&&r.nextPage(...e)),disabled:o.currentPage===r.totalPages,class:"pagination-button next-page-button"}," 下一页 ",8,ce),(0,s.Lk)("div",ge,[(0,s.Lk)("label",null,[t[24]||(t[24]=(0,s.eW)(" 跳转到： ")),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=e=>o.pageInput=e),min:"1",max:r.totalPages,class:"page-input"},null,8,pe),[[n.Jo,o.pageInput,void 0,{number:!0}]])]),(0,s.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>r.jumpToPage&&r.jumpToPage(...e)),class:"jump-button"},"跳转")])]),(0,s.Lk)("div",he,[t[25]||(t[25]=(0,s.Lk)("h3",null,"添加新的 RSS 源",-1)),(0,s.Lk)("div",ke,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>o.newFeed.name=e),placeholder:"名称",class:"add-input"},null,512),[[n.Jo,o.newFeed.name]]),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>o.newFeed.url=e),placeholder:"URL",class:"add-input"},null,512),[[n.Jo,o.newFeed.url]]),(0,s.Lk)("button",{onClick:t[17]||(t[17]=(...e)=>r.addFeed&&r.addFeed(...e)),disabled:o.addingFeed,class:"add-button"},"添加",8,me)])])])])}a(4520),a(4979);var fe={data(){return{feeds:[],newFeed:{name:"",url:""},username:"",refreshingAll:!1,refreshingFeedId:null,deletingFeedId:null,addingFeed:!1,pageSize:10,currentPage:1,pageInput:1,filterDate:"",filterShouldUpdate:"true",searchName:"",logs:[]}},computed:{paginatedFeeds(){const e=(this.currentPage-1)*this.pageSize;return this.filteredFeeds.slice(e,e+this.pageSize)},totalPages(){return Math.ceil(this.filteredFeeds.length/this.pageSize)},filteredFeeds(){return this.feeds.filter((e=>{let t=!0,a=!0,n=!0;return this.filterDate&&(t=this.isSameDay(e.last_updated,this.filterDate)),this.filterShouldUpdate&&(a=e.should_update.toString()===this.filterShouldUpdate),this.searchName&&(n=e.name.toLowerCase().includes(this.searchName.toLowerCase())),t&&a&&n}))}},created(){this.setDefaultFilters(),this.fetchFeeds(),this.getUsername()},methods:{async startTaskQueue(){try{const e=await P();alert(e.data.message)}catch(e){console.error("Error starting queue:",e),alert("启动任务队列时发生错误，请查看控制台。")}},viewLogs(){this.$router.push({name:"LogViewer"})},viewMagnets(e){this.$router.push({name:"MagnetManager",params:{rssFeedId:e.id}})},getUsername(){const e=localStorage.getItem("token");if(e)try{const t=JSON.parse(atob(e.split(".")[1]));this.username=t.username}catch(t){console.error("无法解析 JWT token:",t)}},logout(){localStorage.removeItem("token"),this.$router.push({name:"Login"})},setDefaultFilters(){const e=new Date,t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0");this.filterDate=`${t}-${a}-${n}`,this.filterShouldUpdate="true"},isSameDay(e,t){if(!e)return!1;const a=new Date(e),n=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`;return n===t},async fetchFeeds(){try{const e=await v();this.feeds=e.data.map((e=>({...e,should_update:e.should_update,last_updated:e.last_updated?this.formatDate(e.last_updated):null,isEditing:!1,newName:e.name,newUrl:e.url})))}catch(e){console.error("Error fetching RSS feeds:",e)}},formatDate(e){const t=new Date(e),a=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getDate().toString().padStart(2,"0"),l=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),r=t.getSeconds().toString().padStart(2,"0");return`${a}/${n}/${s} ${l}:${o}:${r}`},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},prevPage(){this.currentPage>1&&this.currentPage--},jumpToPage(){this.pageInput>=1&&this.pageInput<=this.totalPages&&(this.currentPage=this.pageInput)},async addFeed(){if(this.newFeed.name&&this.newFeed.url){this.addingFeed=!0;try{await y(this.newFeed),this.fetchFeeds(),this.newFeed.name="",this.newFeed.url=""}catch(e){console.error("Error adding RSS feed:",e)}finally{this.addingFeed=!1}}},confirmDeleteFeed(e){confirm("确定要删除该 RSS 源吗？此操作不可撤销。")&&this.deleteFeed(e)},async deleteFeed(e){this.deletingFeedId=e;try{await S(e),this.fetchFeeds()}catch(t){console.error("Error deleting RSS feed:",t)}finally{this.deletingFeedId=null}},async refreshAllRssFeeds(){this.refreshingAll=!0;const e=this.feeds.filter((e=>e.should_update));try{await E(e.map((e=>e.id))),alert("勾选的 RSS 源已刷新，新任务已添加！"),await this.fetchFeeds()}catch(t){console.error("Error refreshing all RSS feeds:",t)}finally{this.refreshingAll=!1}},async refreshSingleRssFeed(e){this.refreshingFeedId=e;try{await C(e),alert(`RSS 源 ID ${e} 已刷新，新任务已添加！`),await this.fetchFeeds()}catch(t){console.error("Error refreshing RSS feed:",t)}finally{this.refreshingFeedId=null}},async updateShouldUpdate(e){try{await F(e.id,{should_update:e.should_update}),await this.fetchFeeds()}catch(t){console.error("Error updating should_update status:",t)}},editFeed(e){e.isEditing=!0},async saveFeedChanges(e){try{e.name!==e.newName&&await w(e.id,{old_name:e.name,new_name:e.newName}),await F(e.id,{url:e.newUrl,should_update:e.should_update}),e.name=e.newName,e.url=e.newUrl,e.isEditing=!1}catch(t){console.error("Error saving feed changes:",t)}},cancelEdit(e){e.isEditing=!1,e.newName=e.name,e.newUrl=e.url},applyFilters(){this.currentPage=1}}};const be=(0,d.A)(fe,[["render",Le],["__scopeId","data-v-37af35fa"]]);var ve=be;const ye={class:"container"},Se={class:"header"},Fe={key:0},we={key:1},Ce={class:"tasks-section"},Ee={class:"magnet-table"},_e=["innerHTML"],Ie=["href"],Re=["onClick","disabled"],Pe={key:0,class:"no-tasks-message"};function Ue(e,t,a,n,l,o){return(0,s.uX)(),(0,s.CE)("div",ye,[(0,s.Lk)("header",Se,[l.rssFeed?((0,s.uX)(),(0,s.CE)("h2",Fe,"任务管理 - "+(0,p.v_)(l.rssFeed.name)+" (共"+(0,p.v_)(o.totalEpisodes)+"集)",1)):((0,s.uX)(),(0,s.CE)("h2",we,"正在加载任务管理...")),(0,s.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$router.push({name:"RSSFeeds"})),class:"primary-button back-button"},"返回 RSS 管理")]),(0,s.Lk)("section",Ce,[(0,s.Lk)("table",Ee,[t[1]||(t[1]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"序号"),(0,s.Lk)("th",null,"标题"),(0,s.Lk)("th",null,"状态"),(0,s.Lk)("th",null,"磁力链接"),(0,s.Lk)("th",null,"操作")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.sortedMagnets,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,p.C4)({"incomplete-task-row":!e.status,"completed-task-row":e.status})},[(0,s.Lk)("td",null,(0,p.v_)(t+1),1),(0,s.Lk)("td",{innerHTML:o.highlightEpisodeNumber(e.title)},null,8,_e),(0,s.Lk)("td",null,(0,p.v_)(e.status?"已上传":"未上传"),1),(0,s.Lk)("td",null,[(0,s.Lk)("a",{href:e.magnet_link,target:"_blank"},"查看链接",8,Ie)]),(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:t=>o.retryMagnet(e),disabled:l.retryingMagnetId===e.id,class:"primary-button retry-button"}," 重试 ",8,Re)])],2)))),128))])]),0===o.sortedMagnets.length?((0,s.uX)(),(0,s.CE)("p",Pe,"没有找到相关的任务。")):(0,s.Q3)("",!0)])])}a(3949);var De={props:{rssFeedId:{type:String,required:!0}},data(){return{rssFeed:null,magnets:[],retryingMagnetId:null,patterns:[/\[(\d{2})\]/,/第\s*(\d{2})\s*集/,/第\s*(\d{2})\s*話/,/\s+(\d{2})\s+/,/\b(\d{2})\b/]}},computed:{sortedMagnets(){return this.magnets.slice().sort(((e,t)=>{const a=this.extractEpisodeNumber(e.title),n=this.extractEpisodeNumber(t.title);return null!==a&&null!==n?n-a:null!==a?-1:null!==n?1:t.id-e.id}))},totalEpisodes(){return this.sortedMagnets.length}},created(){this.fetchRssFeedDetails()},methods:{async fetchRssFeedDetails(){try{const e=await _(this.rssFeedId);this.rssFeed=e.data,this.fetchMagnets()}catch(e){console.error("Error fetching RSS feed details:",e),alert("无法加载 RSS Feed 详情，请检查控制台日志。")}},async fetchMagnets(){try{const e=await I(this.rssFeed.id);this.magnets=e.data}catch(e){console.error("Error fetching magnets:",e),alert("获取任务时发生错误，请检查控制台日志。")}},async retryMagnet(e){this.retryingMagnetId=e.id;try{await R(e.id),alert(`任务 ID ${e.id} 重试成功！`),this.fetchMagnets()}catch(t){console.error("Error retrying magnet:",t),alert("重试任务时发生错误，请检查控制台日志")}finally{this.retryingMagnetId=null}},extractEpisodeNumber(e){for(const t of this.patterns){const a=e.match(t);if(a&&a[1])return parseInt(a[1],10)}return console.warn(`无法提取集数的标题: ${e}`),null},highlightEpisodeNumber(e){let t=e;return this.patterns.forEach((e=>{t=t.replace(e,(e=>`<strong class="highlight">${e}</strong>`))})),t}}};const $e=(0,d.A)(De,[["render",Ue],["__scopeId","data-v-7756c8c2"]]);var Ae=$e;const Me={class:"container"},Ne={class:"header"},xe={class:"log-viewer-section"},Xe={class:"filter-container"},Oe={class:"filter-item"},Te={class:"filter-item"},Ve={class:"filter-item"},je={class:"filter-item checkbox-filter"},Je={class:"filter-item filter-button"},qe={key:0,class:"loading-spinner"},ze={key:1,class:"no-logs-message"},Qe={key:2,class:"logs-container"},We={class:"log-time"},Ge={class:"log-level"},Be={class:"log-message"},He={key:3,class:"pagination"},Ke=["disabled"],Ye={class:"pagination-info"},Ze=["disabled"];function et(e,t,a,l,o,r){return(0,s.uX)(),(0,s.CE)("div",Me,[(0,s.Lk)("header",Ne,[t[9]||(t[9]=(0,s.Lk)("h2",null,"系统日志查看器",-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$router.push({name:"RSSFeeds"})),class:"primary-button back-button"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"fas fa-arrow-left"},null,-1),(0,s.eW)(" 返回 RSS 管理 ")]))]),(0,s.Lk)("section",xe,[(0,s.Lk)("div",Xe,[(0,s.Lk)("div",Oe,[t[11]||(t[11]=(0,s.Lk)("label",{for:"log-level"},"日志级别：",-1)),(0,s.bo)((0,s.Lk)("select",{id:"log-level","onUpdate:modelValue":t[1]||(t[1]=e=>o.selectedLevel=e),class:"select-input"},t[10]||(t[10]=[(0,s.Fv)('<option value="ALL" data-v-9578952e>所有</option><option value="DEBUG" data-v-9578952e>DEBUG</option><option value="INFO" data-v-9578952e>INFO</option><option value="WARNING" data-v-9578952e>WARNING</option><option value="ERROR" data-v-9578952e>ERROR</option><option value="CRITICAL" data-v-9578952e>CRITICAL</option>',6)]),512),[[n.u1,o.selectedLevel]])]),(0,s.Lk)("div",Te,[t[12]||(t[12]=(0,s.Lk)("label",{for:"start-date"},"开始日期：",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date",id:"start-date","onUpdate:modelValue":t[2]||(t[2]=e=>o.startDate=e),class:"date-input"},null,512),[[n.Jo,o.startDate]])]),(0,s.Lk)("div",Ve,[t[13]||(t[13]=(0,s.Lk)("label",{for:"end-date"},"结束日期：",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date",id:"end-date","onUpdate:modelValue":t[3]||(t[3]=e=>o.endDate=e),class:"date-input"},null,512),[[n.Jo,o.endDate]])]),(0,s.Lk)("div",je,[t[14]||(t[14]=(0,s.Lk)("label",{for:"include-details"},"显示详细信息：",-1)),(0,s.bo)((0,s.Lk)("input",{type:"checkbox",id:"include-details","onUpdate:modelValue":t[4]||(t[4]=e=>o.includeDetails=e),class:"checkbox-input"},null,512),[[n.lH,o.includeDetails]])]),(0,s.Lk)("div",Je,[(0,s.Lk)("button",{class:"primary-button",onClick:t[5]||(t[5]=e=>r.fetchLogs(1))},"筛选日志")])]),o.isLoading?((0,s.uX)(),(0,s.CE)("div",qe,t[15]||(t[15]=[(0,s.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,s.eW)(" 正在加载日志... ")]))):(0,s.Q3)("",!0),o.isLoading||0!==o.logs.length?((0,s.uX)(),(0,s.CE)("div",Qe,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.logs,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:(0,p.C4)([r.getLogLineClass(e),"log-line"])},[(0,s.Lk)("span",We,(0,p.v_)(r.extractLogTime(e)),1),(0,s.Lk)("span",Ge,(0,p.v_)(r.extractLogLevel(e)),1),(0,s.Lk)("span",Be,(0,p.v_)(r.extractLogMessage(e)),1)],2)))),128))])):((0,s.uX)(),(0,s.CE)("div",ze,"没有找到符合条件的日志")),o.totalPages>1?((0,s.uX)(),(0,s.CE)("div",He,[(0,s.Lk)("button",{class:"secondary-button",onClick:t[6]||(t[6]=e=>r.changePage(o.page-1)),disabled:o.page<=1}," 上一页 ",8,Ke),(0,s.Lk)("span",Ye,"第 "+(0,p.v_)(o.page)+" 页，共 "+(0,p.v_)(o.totalPages)+" 页",1),(0,s.Lk)("button",{class:"secondary-button",onClick:t[7]||(t[7]=e=>r.changePage(o.page+1)),disabled:o.page>=o.totalPages}," 下一页 ",8,Ze)])):(0,s.Q3)("",!0)])])}var tt={data(){return{logs:[],selectedLevel:"ALL",startDate:"",endDate:"",includeDetails:!1,page:1,pageSize:20,totalPages:1,isLoading:!1}},methods:{fetchLogs(e){this.page=e,this.isLoading=!0,U(this.selectedLevel,this.startDate,this.endDate,this.includeDetails,this.page,this.pageSize).then((e=>{e.data.logs&&e.data.logs.length>0?(this.logs=e.data.logs,this.totalPages=e.data.total_pages):(this.logs=[],this.totalPages=1)})).catch((e=>{console.error("无法获取日志:",e),alert("获取日志时发生错误，请检查控制台日志。")})).finally((()=>{this.isLoading=!1}))},changePage(e){e>0&&e<=this.totalPages&&this.fetchLogs(e)},getLogLineClass(e){return e.includes("| DEBUG |")?"log-line-debug":e.includes("| INFO |")?"log-line-info":e.includes("| WARNING |")?"log-line-warning":e.includes("| ERROR |")?"log-line-error":e.includes("| CRITICAL |")?"log-line-critical":"log-line"},extractLogTime(e){return e.split(" | ")[0]},extractLogLevel(e){return e.split(" | ")[1]},extractLogMessage(e){return e.split(" | ").slice(2).join(" | ")}},mounted(){this.fetchLogs(this.page)}};const at=(0,d.A)(tt,[["render",et],["__scopeId","data-v-9578952e"]]);var nt=at;const st={class:"not-found"};function lt(e,t,a,n,l,o){return(0,s.uX)(),(0,s.CE)("div",st,t[0]||(t[0]=[(0,s.Lk)("h1",null,"404 - 页面未找到",-1),(0,s.Lk)("p",null,"抱歉，您访问的页面不存在。",-1)]))}var ot={name:"NotFound"};const rt=(0,d.A)(ot,[["render",lt],["__scopeId","data-v-3a6d8836"]]);var it=rt;const dt={class:"container"},ut={class:"header"},ct={class:"logs-section"},gt={class:"login-log-table"},pt={key:0,class:"no-logs-message"};function ht(e,t,a,n,l,o){return(0,s.uX)(),(0,s.CE)("div",dt,[(0,s.Lk)("header",ut,[t[1]||(t[1]=(0,s.Lk)("h2",null,"登录记录",-1)),(0,s.Lk)("button",{class:"primary-button return-button",onClick:t[0]||(t[0]=t=>e.$router.push({name:"RSSFeeds"}))}," 返回 RSS 管理 ")]),(0,s.Lk)("section",ct,[(0,s.Lk)("table",gt,[t[2]||(t[2]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"时间"),(0,s.Lk)("th",null,"IP 地址"),(0,s.Lk)("th",null,"用户名")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.logs,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,p.C4)(o.getRowClass(t))},[(0,s.Lk)("td",null,(0,p.v_)(e.time),1),(0,s.Lk)("td",null,(0,p.v_)(e.ip_address),1),(0,s.Lk)("td",null,(0,p.v_)(e.username),1)],2)))),128))])]),0===l.logs.length?((0,s.uX)(),(0,s.CE)("p",pt,"没有找到相关的登录记录。")):(0,s.Q3)("",!0)])])}var kt={data(){return{logs:[]}},methods:{fetchLoginLogs(){$().then((e=>{this.logs=e.data.logs})).catch((e=>{console.error("无法获取登录记录:",e),alert("无法获取登录记录，请检查控制台日志。")}))},getRowClass(e){return e%2===0?"even-log-row":"odd-log-row"}},mounted(){this.fetchLoginLogs()}};const mt=(0,d.A)(kt,[["render",ht],["__scopeId","data-v-03a9ea26"]]);var Lt=mt;const ft=[{path:"/",name:"RSSFeeds",component:ve,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:N},{path:"/magnets/:rssFeedId",name:"MagnetManager",component:Ae,meta:{requiresAuth:!0},props:!0},{path:"/logs",name:"LogViewer",component:nt,meta:{requiresAuth:!0}},{path:"/login-logs",name:"LoginLogs",component:Lt,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"NotFound",component:it}],bt=(0,g.aE)({history:(0,g.LA)(),routes:ft});bt.beforeEach(((e,t,a)=>{const n=localStorage.getItem("token");e.matched.some((e=>e.meta.requiresAuth))?n?a():a({name:"Login"}):a()}));var vt=bt;const yt=(0,n.Ef)(c);yt.use(vt),yt.mount("#app")}},t={};function a(n){var s=t[n];if(void 0!==s)return s.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,n,s,l){if(!n){var o=1/0;for(u=0;u<e.length;u++){n=e[u][0],s=e[u][1],l=e[u][2];for(var r=!0,i=0;i<n.length;i++)(!1&l||o>=l)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(r=!1,l<o&&(o=l));if(r){e.splice(u--,1);var d=s();void 0!==d&&(t=d)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[n,s,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,l,o=n[0],r=n[1],i=n[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(s in r)a.o(r,s)&&(a.m[s]=r[s]);if(i)var u=i(a)}for(t&&t(n);d<o.length;d++)l=o[d],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(u)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(2048)}));n=a.O(n)})();
//# sourceMappingURL=app.b19cc19b.js.map